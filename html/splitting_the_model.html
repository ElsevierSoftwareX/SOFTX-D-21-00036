<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2020b"><title>Splitting the model function</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S3 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.S4 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S5 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S9 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Splitting the model function</span></h1><div  class = 'S1'><span>Splitting the system and cost function may significantly reduce the optimization time for complex models where many operations are evaluated involving several state and control varialbles.</span></div><div  class = 'S1'><span>In particular, it is effective if at least part of the operations performed by the system and cost function do not involve the state variables.</span></div><div  class = 'S1'><span>Consider the standard form for the state dynamics and stage cost in DynaProg:</span></div><ul  class = 'S2'><li  class = 'S3'><span>system dynamics    </span><span texencoding="x_{k+1} = f(x_k, u_k, w_k) \qquad  k = 0,1,...,N-1,
" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="259.5" height="20" alt="x_(k+1) = f(x_k, u_k, w_k), for k = 0,1,...,N-1," /></span></li><li  class = 'S3'><span>stage cost               </span><span texencoding="g(x_k,u_k,w_k)" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="73" height="20" alt="g(x_k, u_k, w_k)" /></span><span>. </span></li></ul><div  class = 'S1'><span>Splitting the model function means to split the system dynamics and the stage cost in two distinct phases.</span></div><ul  class = 'S2'><li  class = 'S3'><span>system dynamics    </span><span texencoding="x_{k+1} = f_{int}(x_k,u_k, w_k,  f_{ext}(u_k, w_k) )\qquad  k = 0,1,...,N-1,
" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="331.5" height="20" alt="x_(k+1) = f(x_k, u_k, w_k), for k = 0,1,...,N-1," /></span></li><li  class = 'S3'><span>stage cost               </span><span texencoding="g_{int}(x_k,u_k,w_k, g_{ext}(u_k,w_k))" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATQAAAAoCAYAAABw4gbLAAASzklEQVR4Xu3dCfR+XzUG8CdahgaSoskQRcmUFGVqMpRCgyJDqcxliAwZokRRhiIUZWwiChkaRESDIWWslKFCUabMZH3+62zrrNu9773v9J3cu9Z/9ev33ve95+yzz7Of/ex97u9SWa/VAqsFVgtcEAtc6oLMY53GaoHVAqsFsgLa6gSrBVYLXBgLrIB2YZZynchqgdUCK6CtPrBaYLXAhbHARQC0Kya5fpJnJ/mfC7My60TOqwXeNslHJHlOkn87r5M40rivm+TSSV6y4PffIsnNkvxuktcvuP+SW847oF07yb2TPCjJ3yyd9HrfaoEjWeDKSb42yfcl+aMjPeM8/+xbJ7lXkj9M8otJ3jQzmasn+bIk35Xkz5dM/DwD2nsnuU+Sr1/BbMlSr/cc2QLvnOQbkjx8BbONlsbQkJA/Xghq7PqVS0HtvAKaSAi1vz/Jrx7ZUdefXy0wZwFp5kOSPC/J4xcwj7nfu+if27/s9W0Lwf/DknxKkq9K8sZNxjmPgPaWjZmhrw9O8l8XffXX+Z15C9hsN23p0cYNd+ZncnID/Mgkn9PY2htmHmvPf0WSf2kMeDJVPY+Adr0kj0jy+Un+5OTsvz5ptcCoBa6a5NFJvrUVAlYzLbMAQsJmL07ygwu+cs0k39uCxh9M3X/eAA1S379VSr4uyX8vMMR6y2qBY1rgHkk+KskXJvmnYz7oAv72Rzfm9ZlJ/moBS3tgy8i+cWrvnzdAe7ckj2vi6zMu4AKvUzpfFnj7JD+Q5JlNzz1foz/90V4tyY+3jOunFgwHAAK1T03yyrH7zxugfUKratIsXr7AAOstqwWOaYEbJHlyE6wVBNZrOwu8TZKHJfn3Jvj/x8zXr5XkCUkekORnzjugSTehs96zeyb5h+1sd6bvFljerqXSihz/uFbKzvR61eA+N4l06S5L+6RmZqVaepnWIC59/f9Q8PrSJLduNnzdjH2KEdPQpJ1vVhxYwtDetUWgj2msSBXnA5I8pf33r007mEPXfT308km+J8nfLkDzyya5YZLbJfnYJMrEd0vys20Qfuu+TfeQuuqLmTPmLuNnX30010nyPm1MxvYFbR71m4TlH0lyyySfd8T0xbw/KMn7J/nwJAosd03y2yOTUyq/Q5L7dR3vhFx9fwLKQ5N8xwluurPih2WqbQKsNbf+gvEHJrlJ6616bmf30odpwz96RE3OGjpZY+35wI2bjjXGeIz3a5IAnapE8mk++k1tnD7fp7Ir6+JLd2wFgk377K1aZ8OVpuyzCdAcPZDaqSj+ZpIvSvKKdrrABFHFuhimX5xdNv/cd4AS/cyREkxt03WN9uF/tl6Xz+icxPGob0kiGn5IO1Yhyv7F3AB2+LyYFwd6ZBJHP4CAfpo+AFjUp7bAIHAcM30xJqkSADUegObP/cXWevz+LskXt3K5zzkU2yuhA8GTSP3Pmh+WnTApvZAKU/aDwD518TVBy4kWNvuNEVZX+jCwE0T46DEvVUPVRceLsJ0h4zFmVUjBGAPtA75uf7iARe7rrwLnr7fCir09dwF8LR/DMV3yvU2A9okNBP65LUL/sE9L8mNJfiWJP79mbhQH+NzJgCe20q3NtvSSFjiKYgMCttsmedUJN0BW7g9IPr0JoTX+Kl8LGCdlz2K77DF05urz48y/1NYXsNXlu9+eRNDwfYz5mNdZ88Oa6zu2dfydJEsq7qUXYef8dwiCt296nN8HEscuehXD/OpW2OgDlzEA3kc1EnPnQYsUnxXUMPjhZ9v6wocmeXprw1IgmLuM1zNHnzsFaL3D/1A7f9XTygKJ3zvAhOYmUJ8XoOkuXjLx+h4QkWqKkBzJBnRE5ST1CdUZi/ayEWqN+v/EBva21D7b3Gfdtb/4b7i5REx/Z1xjAFsbwdlZx3zmzuNtM67hvWfRD4eAJjOZyxh8pyp6GnCHsoKU9LubLDLG3vax4abvykx+eCRwSTUf26SJv55IB2FApaRE/V2vbfc1AkUu2grQekbhvKQ0qa7KY0UY5epR6rfr7DZ8b9uJ10/1juSNHFjFq48wvqmfBB50Bk7/k4OChs/69H3I3o45zDFnriMpv9bSo9eOOM67t7lIm49tx7Poh7sCmkDxC0lkPLKEXre8UdOjK+jOpbCH8gupm6ODPTGRakqNHa6nO0uBh5LSOzTJ6TsX6F5zY912X+8NaMNNJvd2Xo3+hHZKP06iwXXXlLOn+mP6VRncoVmMgJaB1Vnk35pbjQWf9yxDasJZitX0ttRYOHR0zqX6Sesy/59OAmQOcZVuV1rYn7UubK9qIS9I799joJGwkTWnpSqf13W5JFdI8r6NifjuPkJx/e6mVP20/HAIaEtTzspqvGWiT9V7ycFvDwnEsfzSsyp7sX7S3Oe3Hi8FDBoZ9qaoJv20pi5BGKgA337v7+qrpaH1z9jk3/YQGWJUv51KOXsK3NNjxhWZsQ0itkUae22PhxFM5eW94++zEbcpCvTPMUcU1WHYoTP195mbZ+hx0fmNwRxCnC8gVhnutZHelsYxNjZOwrmIt95OoBu917P2sWc5kndT3alVY3W9WzNjU4BRde2js/FLn70ip08zbAj3PSbJk1oFb580pOa1rx/uY5+5725bFBBM7Rdif6+53bzp0QCCyH6rQYHtWH5pfr1v8nnCv+qlV/YInPawinZPalTIv6Td05/B3NVXyw+XFhbZzneA6pvthU1FAZO1kVBkVQ3phYmZMLSmQ029eE3ljKiMOh/q7QPbtG30zvjBLdXDvMY0rP7eclJp1ZLjGHNO7/NiQkO9sUCTuA4oho5ev63KBCS0yUwe+VgykME99bvv1wCNwCsq04RK8Bady5mxRI4ufR4LYpW+2ABLzuYtHfI+frj0Gbvct03bRl/B7MFBS48ACrTuvqEodAy/NOciCQKXs9EYtoojEgKgCoS16iAxxivD0OEw9r63XXwVMHk9kKAqaG+6akxsPyxi/B99nPoBYCetFI1f0CLyXyahr6gSHlMMttltkG/u0tnSojCdpY21FkCUUTHiMPSATTpV6W3Ah5H3ZRl9JanvLfLiOm8KcdwDcySuotFjvUBVUFAFk3Ie6uqjMyGavlNvL+mdWXBS7TRO/029uBD7AHiHYrY1z9P0wxoDP7IP+GN/5tBmVLWca6wdKwoBMaRAkL1FS0OnJJFD+2XNqw9cshF+bw1LLsCGAK5ACsSAGh/95Qkn3MVXVS0xLmn43Fs3aHf2kaA72tYyxdD8vfNS2h2ws2Gf0qE21djvyOs10No8ww3MYKqcS0rFpffQhqTHFqSn/PrRvCrZGzuKcZRwK1pNVVIVRbBF6cFcM3F1NmsaLG1EGlUp+1VaNCz2hvFaWFVGTlUg7vub5gyAaIXbdJf3gMZBAD1bufrCD52EzgP0pth2AaC06bMndL7qyfP7S09CnKYflm96xTug9+qaYZCTfmEz5rypD1Omwo5VFDJ/+ws7V4G3Saulx+9J/Yn19TaZQ/vlGKB5Iyw/63XjGrdOBxka/7KPxjoElvpqv+cr6+J3S7KPsrdG+GeNgccUoBUSfnySF7aHKeHPCb3SEk2kuqFN2sZ9r6bFqOR4nn4r1BaN1RpQHfyiEI2IZseJlLFFAhGhig7VUe81IsPDrLVh3GucHEaPCyfU9DgUZT1bqicCFROzgJyTBujSdAgoHITFUvwZ2GBTnM37nDY1A/ZpHdZJgNc0yaE5uPRN6wRHN3dgxqHqpZUFiDYTQDQfNnaJqERcwrkSOzZtU9kMS16r1Edn83DIumfdFZ05sXXcdCqgUio+IhDxm3dpdjUXOh1AFiA5Mda8pMN8Vz/s2Z01+Lgkuss921xoRQDEOtrE1tDas7eUCmP65OangptTJz/f/qMtFpMojc/82Gcsa6l0UVZh0/K3T2oplrRJYGEjzI88oQgkC5H+F3Ac2i/LPj0Txz75Yg9W1W/q/rk1W+KrGt37y9wRB3t0FKAG9xsPvJiUg6YArW+u7H/z5xp70v4wlY5VOwDhECgBmNJXOLG0FQOQthLCOVihM6cTrQiSUNjG769qc7CBVNv6MQBROhMwfGnr/OeMxb760jjGRhtEr+vzihYWBqhhSxxORY8ze1YJmDWmsQbJfrz9/Viu1IXzAjMd8KVRsKfUw2c9CxKRgB3AoknSPBQ4/H/n2Wyg3uk8e1hJHQtk/q4AjY2B/ZDu1zoqAk1F5frtSjV6vU2Kb1M6gdFvHN8ZE7/HxrmPH1pPY+dT0pp3alok9l+N2VVhNH42uE3rF2RnLUlEZz4rpRTkvLtreJECzFsgGUuZ+sAB8AVHFWH+jfXU+gG0KqBZwyIPx/DLIaAhGD1Dr89r3zrlYr9tIjRLfHVoOzaj04753/DeCh4v2tT/OAZo/s75LtqAsi0GgO1Iz+ryQjvOMiwKFO30XQ5Q7MWiSRVFNxuXaOxAKmDptaEqI4vyBYbDiRHsOSRH6+kxsLDxRDmOgQFqCuwXTwSyUQGpPwPXuioFe1orfBDJOZ9UqyJvPcN8XGOd9P14bQybGjuhPYrOWGf961RYANbCsUVI4DWMkNgoFuFfv7EO7ulPZhi3TYpVuOZAtsYHuH3PWo69xpwdVeDmmFSteW16bBJAWOt6gYB7zBUoC0auuZ67ffyQ83vWezbGL53CkDAdmqCso64CbuwZyDjm19sIcxWUpyrMWKQ1Eoj48/AqAbuKaJiODvwCB/tLSod58wU+3O+rY/hljRGx4HdaT8bkBPuRzfrAPzLFS/7Knpjz1f677MYO/E/T+dyFkCA+1nGy/3EIaCIWViK16dkNNqF9ADvgAC6LD3T6q2inqFQNrL0eY+EYRySzUYbaEKQGND0YDidauorUdtg+MGeUTZ9XNRKzEEEVEn5/wxfqPNmxmiDLbgoZWCyHt/ib3jJibRzi7nvd9rHJku/WmgN9mwIjcixu6myjFAwzxVindKd9/bBYDx80JkETIKnQ9wHF/CqIygz4ZB9Qhqxjqt+SnFAtL3PC9hKb9vecNb8cG/8uvmqN4Azmt+kcrOdh+LIagXdjG9gQ0IpJyfFVNodXneHCNMaYQDmAFK0E1KrQYDcWXQTs8+1KLcso2ixEeynp1FX/KAX2dIg+t76b3zMxNzYQucauKjhgiEuiy7ZO7P5Kv+k/LsejpMJTgIaV2LDS0bHUaJcxLPlOX1xwP8fD3od6Sf0WYMbggcdQUqh79vHDshvtFpulSWHH2PRYD5/mYT5krYfBqcBENqEKPHVValzzP1Sj+Vn0yzEbbOurfKD63aoQNWXbrQhMD2jVUU/32VRRK11orG+qImOfTlSFBgAWoyqxXOpZqWUBH0F7CeuhlQFNkXUTk1qyKXuWIeWUJhrX2KHjMrAKlc17rDOhxRykKBzmyzccWgawigYnfeiebWvTSwUwFVF36lUwc31Mfm9fPyy7AbMqCE35ALvJOmQjfzp40UK13ACzJVV1QZZurFBDEz1EW9NZ9MsxW27jq9vuW7+NYas0z77ivAe0WkBtGsNu5X4SWJaNDrz6lKEYFt2FA9CJCMKisdyXkxebMUCAIbUkztM4gJwoKCUlnvpXp3uNa8yQjON+Fc+xd3otATP39KkFzQT40jY0+9HRAIq8XepNgzE3UX3fPrVN4+vTb7ZQ8AC2JAGbHgvA1vxZ5VilDQs5yX89frjpVY69wbXe4KEt5e9bSkH75At0IoWWTWxHir2rH04FXAyWv/Q+BYzJIz4TxHSrC460T+OuAhU2CYznfAyoyTgwZGuxL6idRb8cW7elvlr7lb46+Q+ddA8AZvW+tFkw871hyskZ+mM2vfhmMwM6Ghe01CPWL1iV2KUR0iPHYdzj5W30N/oOetmnlg630nwAiHYNkVI6y6E4/lxubQ7SYO0cQHFXB+oFTaBbr6wBujqn2UkavevvLwXWuq+qgtKmOvdHF9Negf0CB+0sc3R92+due/+wKg3grKWqGfAiHzgONXWiZOp5+/ghf6LPSTX5nI1DbxWIsF2Xdhy+7X8VoKRAgqnClQCLYZmLHjE+wA/ZG4ubu+wT6yOY78vez5pfjs19G1+V1bDlkuN77E8OYMfFxGGsyllvBsW0VAl1hhNy/T39C1MYOyAtyhF7VQflxwBJqRwaqyqVplZ6A5bnfmkbpiEiq7goHFSv0JzzHOLzXtCsf3zBImF+n9VKxKoxS8D1EOPxG9XX1dvN37EXEFExO1Ras8+Yx6rS3ojrtUJ8RHBSZt/l2tUPPUvaq8pZjdPWT8XeRpJCYl5akEggGFu90FLglTZiV/VWZv92BU0QOzupgGYOZ9Evx9bxTPnqVB/aLg64fme1wGqB1QKnaoEV0E7V/OvDVwusFjikBVZAO6Q1199aLbBa4FQtsALaqZp/ffhqgdUCh7TACmiHtOb6W6sFVgucqgVWQDtV868PXy2wWuCQFvhfqm9mdE974KAAAAAASUVORK5CYII=" width="154" height="20" alt="g(x_k, u_k, w_k)" /></span><span>. </span></li></ul><div  class = 'S1'><span>The </span><span style=' font-style: italic;'>external</span><span> model performs all calculations in which the values of the state variables are not involved. The </span><span style=' font-style: italic;'>internal </span><span>model performs the remaining calculations. </span></div><div  class = 'S1'><span>The reason why the external model is named so is because it can be run before the backward phase (see </span><a href = "./theory.html"><span>theory</span></a><span>), on a different (much smaller in size) computational grid which does not involve the state variables. Performing part of the calculations on this reduced computational grid is the advantage of this approach.</span></div><div  class = 'S1'><span>In practice, you will:</span></div><ul  class = 'S2'><li  class = 'S3'><span>Create an external function to generate some </span><span style=' font-style: italic;'>intermediate</span><span> </span><span style=' font-style: italic;'>variables</span><span>,</span></li><li  class = 'S3'><span>create and internal function to evaluate the updated system state and the stage cost based on the state variables, control variables,  exogenous inputs (optionally) and the intermediate variables.</span></li></ul><h2  class = 'S4'><span>Create the external system and cost function</span></h2><div  class = 'S1'><span>Create the external system and cost function with signature:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">function </span><span>[intVar, unfeas] = sysfun_ext(u, w)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>   </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S8'><span>Your function should accept as the first input the control variables </span><span style=' font-family: monospace;'>u.</span><span> The second input can be used to pass an </span><a href = "./handle_exogenous_inputs.html"><span>exogenous input</span></a><span> to the system function. If your system model does not make use of exogenous inputs, you can replace the second input in your function signature with a tilde (~).</span></div><div  class = 'S1'><span>Also, the function should return two outputs: the first output contains the intermediate variables. The intermediate variables are all relevant quantities that you will need to use in the internal function to ultimately evaluate the state update and the stage cost. Treat the intermediate variables as a cell array, with each cell containing one intermediate variable.</span></div><div  class = 'S1'><span>The second output is used to define unfeasibility. Note that the unfeasibilties that you specify in the external function will be combined with those specified in the internal model function, so that both will  be taken into account. If you do not wish to dpecify unfeasibilty, you must still specify a second output in your function signature, but this should return an empty array: you should include anywhere in your function the line </span><span style=' font-family: monospace;'>unfeas = [];.</span></div><div  class = 'S1'><span>You can specify any number of </span><a href = "./use_additional_inputs.html"><span>additional inputs</span></a><span>, but you should not specify any </span><a href = "./use_additional_outputs.html"><span>additional output</span></a><span> as those must be included in the internal function.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">function </span><span>[intVar, unfeas] = sysfun_ext(u, w, addInput1, .., addInputN)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>   </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h2  class = 'S4'><span>Create the internal system and cost function</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre;"><span>[x_new, stageCost, unfeas] = sysfun_ext(x, u, w, intVar)</span></span></div></div></div><div  class = 'S8'><span>Your function should accept four inputs: the first three are the state variables, the control variables and the exogenous inputs</span><span style=' font-family: monospace;'>.</span><span> The fourth input will contain the intermediate variables that your external function returns; remember to treat it as a cell array. Once again, the exogenous inputs can be replaced by a tilde </span><span style=' font-family: monospace;'>~</span><span> if not needed.</span></div><div  class = 'S1'><span>As for the outputs, your internal function should follow the same rules as for regular </span><a href = "./set_up_a_basic_problem.html"><span>system and cost functions</span></a><span>. The first three outputs are the updated state variables, the stage cost and unfeasibility. </span></div><div  class = 'S1'><span>You can also specify any number of </span><a href = "./use_additional_inputs.html"><span>additional inputs</span></a><span> and </span><a href = "./use_additional_outputs.html"><span>additional outputs</span></a><span>.</span></div><h2  class = 'S4'><span>Set up and solve the optimization problem</span></h2><div  class = 'S1'><span>Set up the state and and control variables grids, initial conditions and terminal constraints </span><a href = "./set_up_a_basic_problem.html"><span>as usual</span></a><span>.</span></div><div  class = 'S1'><span>Pass a function handle to the external function as the sixth input argument and a function handle to the internal function as the seventh argument.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>prob = DynaProg(StateGrid, StateInitial, StateFinal, ControlGrid, Nstages, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span> @sysfun_ext, @sysfun_int);</span></span></div></div></div><div  class = 'S8'><span>You can specify any value-pair argument after the two function handles.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>prob = DynaProg(StateGrid, StateInitial, StateFinal, ControlGrid, Nstages, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span> @sysfun_ext, @sysfun_int, </span><span style="color: rgb(170, 4, 249);">'ExogenousInput'</span><span>, w, </span><span style="color: rgb(170, 4, 249);">'StateName'</span><span>, SVnames);</span></span></div></div></div><div  class = 'S8'><span>To pass </span><a href = "./use_additional_inputs.html"><span>additional inputs</span></a><span> to your external and internal functions, parametrize them as you normally would, making sure you specify the correct inputs for the function handles. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span>prob = DynaProg(StateGrid, StateInitial, StateFinal, ControlGrid, Nstages, </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span> @(u, w) sysfun_ext(u, w, addInput1, .., addInputN), @(x, u, w, m) sysfun_int(x, u, w, m, addInput1, .., addInputN), </span><span style="color: rgb(170, 4, 249);">'ExogenousInput'</span><span>, w);</span></span></div></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
function [intVar, unfeas] = sysfun_ext(u, w)
%% SYSFUN_EXT Splitting the model function
% Splitting the system and cost function may significantly reduce the optimization 
% time for complex models where many operations are evaluated involving several 
% state and control varialbles.
% 
% In particular, it is effective if at least part of the operations performed 
% by the system and cost function do not involve the state variables.
% 
% Consider the standard form for the state dynamics and stage cost in DynaProg:
%% 
% * system dynamics    $x_{k+1} = f(x_k, u_k, w_k) \qquad  k = 0,1,...,N-1,$
% * stage cost               $g(x_k,u_k,w_k)$. 
%% 
% Splitting the model function means to split the system dynamics and the stage 
% cost in two distinct phases.
%% 
% * system dynamics    $x_{k+1} = f_{int}(x_k,u_k, w_k,  f_{ext}(u_k, w_k) )\qquad  
% k = 0,1,...,N-1,$
% * stage cost               $g_{int}(x_k,u_k,w_k, g_{ext}(u_k,w_k))$. 
%% 
% The _external_ model performs all calculations in which the values of the 
% state variables are not involved. The _internal_ model performs the remaining 
% calculations. 
% 
% The reason why the external model is named so is because it can be run before 
% the backward phase (see <matlab:open('./theory.mlx') theory>), on a different 
% (much smaller in size) computational grid which does not involve the state variables. 
% Performing part of the calculations on this reduced computational grid is the 
% advantage of this approach.
% 
% In practice, you will:
%% 
% * Create an external function to generate some _intermediate_ _variables_,
% * create and internal function to evaluate the updated system state and the 
% stage cost based on the state variables, control variables,  exogenous inputs 
% (optionally) and the intermediate variables.
%% Create the external system and cost function
% Create the external system and cost function with signature:
   ...
end
%% 
% Your function should accept as the first input the control variables |u.| 
% The second input can be used to pass an <matlab:open('./handle_exogenous_inputs.mlx') 
% exogenous input> to the system function. If your system model does not make 
% use of exogenous inputs, you can replace the second input in your function signature 
% with a tilde (~).
% 
% Also, the function should return two outputs: the first output contains the 
% intermediate variables. The intermediate variables are all relevant quantities 
% that you will need to use in the internal function to ultimately evaluate the 
% state update and the stage cost. Treat the intermediate variables as a cell 
% array, with each cell containing one intermediate variable.
% 
% The second output is used to define unfeasibility. Note that the unfeasibilties 
% that you specify in the external function will be combined with those specified 
% in the internal model function, so that both will  be taken into account. If 
% you do not wish to dpecify unfeasibilty, you must still specify a second output 
% in your function signature, but this should return an empty array: you should 
% include anywhere in your function the line |unfeas = [];.|
% 
% You can specify any number of <matlab:open('./use_additional_inputs.mlx') 
% additional inputs>, but you should not specify any <matlab:open('./use_additional_outputs.mlx') 
% additional output> as those must be included in the internal function.
function [intVar, unfeas] = sysfun_ext(u, w, addInput1, .., addInputN)
   ...
end
%% Create the internal system and cost function
[x_new, stageCost, unfeas] = sysfun_ext(x, u, w, intVar)
%% 
% Your function should accept four inputs: the first three are the state variables, 
% the control variables and the exogenous inputs|.| The fourth input will contain 
% the intermediate variables that your external function returns; remember to 
% treat it as a cell array. Once again, the exogenous inputs can be replaced by 
% a tilde |~| if not needed.
% 
% As for the outputs, your internal function should follow the same rules as 
% for regular <matlab:open('./set_up_a_basic_problem.mlx') system and cost functions>. 
% The first three outputs are the updated state variables, the stage cost and 
% unfeasibility. 
% 
% You can also specify any number of <matlab:open('./use_additional_inputs.mlx') 
% additional inputs> and <matlab:open('./use_additional_outputs.mlx') additional 
% outputs>.
%% Set up and solve the optimization problem
% Set up the state and and control variables grids, initial conditions and terminal 
% constraints <matlab:open('./set_up_a_basic_problem.mlx') as usual>.
% 
% Pass a function handle to the external function as the sixth input argument 
% and a function handle to the internal function as the seventh argument.
prob = DynaProg(StateGrid, StateInitial, StateFinal, ControlGrid, Nstages, ...
 @sysfun_ext, @sysfun_int);
%% 
% You can specify any value-pair argument after the two function handles.
prob = DynaProg(StateGrid, StateInitial, StateFinal, ControlGrid, Nstages, ...
 @sysfun_ext, @sysfun_int, 'ExogenousInput', w, 'StateName', SVnames);
%% 
% To pass <matlab:open('./use_additional_inputs.mlx') additional inputs> to 
% your external and internal functions, parametrize them as you normally would, 
% making sure you specify the correct inputs for the function handles. 
prob = DynaProg(StateGrid, StateInitial, StateFinal, ControlGrid, Nstages, ...
 @(u, w) sysfun_ext(u, w, addInput1, .., addInputN), @(x, u, w, m) sysfun_int(x, u, w, m, addInput1, .., addInputN), 'ExogenousInput', w);
##### SOURCE END #####
--></body></html>